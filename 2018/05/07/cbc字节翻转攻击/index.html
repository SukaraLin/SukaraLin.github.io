<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。">
<meta name="keywords" content="php,ctf">
<meta property="og:type" content="article">
<meta property="og:title" content="cbc字节翻转攻击">
<meta property="og:url" content="http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/index.html">
<meta property="og:site_name" content="l1nk3r&#39;s blog">
<meta property="og:description" content="今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/h7fiz.png">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/kgrow.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/oy56c.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/uv2vw.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/mh3xk.jpg">
<meta property="og:image" content="http://drops.xmd5.com/full/157b4078de6a8615e7c4be958d4d89164f1810e9.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/aizmc.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/t6r5o.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/5342j.jpg">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/wq2wi.png">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/zt02m.png">
<meta property="og:image" content="http://l1nk3r.xmutsec.com/blog/7nb7b.jpg">
<meta property="og:updated_time" content="2019-04-10T04:39:58.602Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cbc字节翻转攻击">
<meta name="twitter:description" content="今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。">
<meta name="twitter:image" content="http://l1nk3r.xmutsec.com/blog/h7fiz.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>cbc字节翻转攻击</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/05/11/蜜罐学习/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/05/04/来聊聊如何构建安全的web应用/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&text=cbc字节翻转攻击"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&is_video=false&description=cbc字节翻转攻击"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=cbc字节翻转攻击&body=Check out this article: http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&name=cbc字节翻转攻击&description=&lt;p&gt;今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前提知识"><span class="toc-number">1.</span> <span class="toc-text">前提知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#举个例子"><span class="toc-number">2.</span> <span class="toc-text">举个例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#收回来解题"><span class="toc-number">3.</span> <span class="toc-text">收回来解题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开始搞事"><span class="toc-number">3.1.</span> <span class="toc-text">开始搞事</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#正式解题"><span class="toc-number">3.2.</span> <span class="toc-text">正式解题</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        cbc字节翻转攻击
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">l1nk3r's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-05-07T14:25:42.000Z" itemprop="datePublished">2018-05-07</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/ctf/">ctf</a>, <a class="tag-link" href="/tags/php/">php</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。</p>
<a id="more"></a> 
<p>右键查看源代码，发现泄漏提示，tip:index.txt</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/h7fiz.png" alt="1"></p>
<p>源代码贴一下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'sqlwaf.php'</span>;</span><br><span class="line">define(<span class="string">"SECRET_KEY"</span>, <span class="string">"................"</span>);</span><br><span class="line">define(<span class="string">"METHOD"</span>, <span class="string">"aes-128-cbc"</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_random_iv</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $iv=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">16</span>;$i++)&#123;</span><br><span class="line">        $iv.=chr(rand(<span class="number">1</span>,<span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $iv;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($info)</span></span>&#123;</span><br><span class="line">    $iv=get_random_iv();</span><br><span class="line">    $plain = serialize($info);</span><br><span class="line">    $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);</span><br><span class="line">    $_SESSION[<span class="string">'username'</span>] = $info[<span class="string">'username'</span>];</span><br><span class="line">    setcookie(<span class="string">"iv"</span>, base64_encode($iv));</span><br><span class="line">    setcookie(<span class="string">"cipher"</span>, base64_encode($cipher));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_homepage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($_SESSION[<span class="string">"username"</span>]===<span class="string">'admin'</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Hello admin&lt;/p&gt;'</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Flag is *************&lt;/p&gt;'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;hello '</span>.$_SESSION[<span class="string">'username'</span>].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Only admin can see flag&lt;/p&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_login</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'cipher'</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">        $cipher = base64_decode($_COOKIE[<span class="string">'cipher'</span>]);</span><br><span class="line">        $iv = base64_decode($_COOKIE[<span class="string">"iv"</span>]);</span><br><span class="line">        <span class="keyword">if</span>($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123;</span><br><span class="line">            $info = unserialize($plain) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"&lt;p&gt;base64_decode('"</span>.base64_encode($plain).<span class="string">"') can't unserialize&lt;/p&gt;"</span>);</span><br><span class="line">            $_SESSION[<span class="string">'username'</span>] = $info[<span class="string">'username'</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"ERROR!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'username'</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</span><br><span class="line">  $username=waf((string)$_POST[<span class="string">'username'</span>]);</span><br><span class="line">  $password=waf((string)$_POST[<span class="string">'password'</span>]);</span><br><span class="line">  <span class="keyword">if</span>($username === <span class="string">'admin'</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">'&lt;p&gt;You are not real admin!&lt;/p&gt;'</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $info = <span class="keyword">array</span>(<span class="string">'username'</span>=&gt;$username,<span class="string">'password'</span>=&gt;$password);</span><br><span class="line">        login($info);</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">"username"</span>]))&#123;</span><br><span class="line">        check_login();</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span> &gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;title&gt;Paper login form&lt;/title&gt;</span><br><span class="line">      &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"css/style.css"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=<span class="string">"login"</span>&gt;</span><br><span class="line">  &lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;h1&gt;Sign In&lt;/h1&gt;</span><br><span class="line">    &lt;input name=<span class="string">'username'</span> type=<span class="string">"text"</span> placeholder=<span class="string">"Username"</span>&gt;</span><br><span class="line">    &lt;input name=<span class="string">'password'</span> type=<span class="string">"password"</span> placeholder=<span class="string">"Password"</span>&gt;</span><br><span class="line">    &lt;button&gt;Sign in&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>首先这里登陆的时候已经禁止username为admin</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/kgrow.jpg" alt="2"></p>
<p>但是我们可以通过反序列化<code>$plain</code>,重置<code>$_SESSION[&#39;username&#39;]</code>为<code>admin</code></p>
<p><img src="http://l1nk3r.xmutsec.com/blog/oy56c.jpg" alt="3"></p>
<h2 id="前提知识"><a href="#前提知识" class="headerlink" title="前提知识"></a>前提知识</h2><p>此攻击方法的精髓在于：<strong>通过损坏密文字节来改变明文字节</strong>。（注：借助CBC内部的模式）借由此可以绕过过滤器，或者改变用户权限提升至管理员，又或者改变应用程序预期明文以尽猥琐之事。</p>
<p>首先让我们看看CBC是如何工作的，（作者很懒所以）更多细节你可以看这里：<a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" target="_blank" rel="noopener">wiki</a></p>
<p>在这里只是解释一下关于攻击必须要理解的部分。（即：一图胜千言）</p>
<p><strong>加密过程</strong></p>
<p><img src="http://l1nk3r.xmutsec.com/blog/uv2vw.jpg" alt="9"></p>
<p><strong>Plaintext</strong>：待加密的数据。</p>
<p><strong>IV</strong>：用于随机化加密的比特块，保证即使对相同明文多次加密，也可以得到不同的密文。</p>
<p><strong>Key</strong>：被一些如AES的对称加密算法使用。</p>
<p><strong>Ciphertext</strong>：加密后的数据。</p>
<p>在这里重要的一点是，CBC工作于一个固定长度的比特组，将其称之为<em>块</em>。在本文中，我们将使用包含16字节的块。</p>
<p>因为作者讨厌高数，所以作者造了一些自己的公式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ciphertext-0 = Encrypt(Plaintext XOR IV)—只用于第一个组块</span><br><span class="line">Ciphertext-N= Encrypt(Plaintext XOR Ciphertext-N-1)—用于第二及剩下的组块</span><br></pre></td></tr></table></figure>
<p>注意：正如你所见，<strong>前一块的密文用来产生后一块的密文</strong>。</p>
<p><strong>Decryption Process</strong></p>
<p><img src="http://l1nk3r.xmutsec.com/blog/mh3xk.jpg" alt="10"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Plaintext-0 = Decrypt(Ciphertext) XOR IV—只用于第一个组块</span><br><span class="line">Plaintext-N= Decrypt(Ciphertext) XOR Ciphertext-N-1—用于第二及剩下的组块</span><br></pre></td></tr></table></figure>
<p>注意：<strong>Ciphertext-N-1（密文-N-1）是用来产生下一块明文</strong>；这就是字节翻转攻击开始发挥作用的地方。如果我们改变<em>Ciphertext-N-1</em>（密文-N-1）的一个字节，然后与下一个解密后的组块异或，我们就可以得到一个不同的明文了！<strong>You got it?</strong>别担心，下面我们将看到一个详细的例子。与此同时，下面的这张图也可以很好地说明这种攻击：</p>
<p><img src="http://drops.xmd5.com/full/157b4078de6a8615e7c4be958d4d89164f1810e9.jpg" alt="enter image description here"></p>
<h2 id="举个例子"><a href="#举个例子" class="headerlink" title="举个例子"></a>举个例子</h2><p>比方说，我们有这样的明文序列：</p>
<p><code>a:2:{s:4:&quot;name&quot;;s:6:&quot;sdsdsd&quot;;s:8:&quot;greeting&quot;;s:20:&quot;echo &#39;Hello sdsdsd!&#39;&quot;;}</code></p>
<p>我们的目标是将“<code>s:6</code>”当中的数字6转换成数字“7”。我们需要做的第一件事就是把明文分成16个字节的块：</p>
<ul>
<li>Block 1:<code>a:2:{s:4:&quot;name&quot;;</code></li>
<li>Block 2:<code>s:6:&quot;sdsdsd&quot;;s:8</code></li>
<li>Block 3:<code>:&quot;greeting&quot;;s:20</code></li>
<li>Block 4:<code>:&quot;echo &#39;Hello sd</code></li>
<li>Block 5:<code>sdsd!&#39;&quot;;}</code></li>
</ul>
<p>因此，我们的目标字符位于块2，这意味着我们需要改变块1的密文来改变第二块的明文。</p>
<p>有一条经验法则是（注：结合上面的说明图可以得到），你在密文中改变的字节，<strong>只</strong>会影响到在下一明文当中，具有相同偏移量的字节。</p>
<p>因此我们要改变在第一个密文块当中，偏移量是2的字节。正如你在下面的代码当中看到的，在第2行我们得到了整个数据的密文，然后在第3行中，我们改变块1中偏移量为2的字节，最后我们再调用解密函数。</p>
<ol>
<li><code>$v = &quot;a:2:{s:4:&quot;name&quot;;s:6:&quot;sdsdsd&quot;;s:8:&quot;greeting&quot;;s:20:&quot;echo &#39;Hello sdsdsd!&#39;&quot;;}&quot;;</code></li>
<li><code>$enc = @encrypt($v);</code></li>
<li><code>$enc[2] = chr(ord($enc[2]) ^ ord(&quot;6&quot;) ^ ord (&quot;7&quot;));</code></li>
<li><code>$b = @decrypt($enc);</code></li>
</ol>
<p>运行这段代码后，我们可以将数字6变为7：</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/aizmc.jpg" alt="11"></p>
<p>但是我们在第3行中，是如何改变字节成为我们想要的值呢？</p>
<p>基于上述的解密过程，我们知道有，<em>A = Decrypt(Ciphertext)</em>与<em>B = Ciphertext-N-1</em>异或后最终得到<em>C = 6</em>。等价于：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C = A XOR B</span><br></pre></td></tr></table></figure>
<p>所以，我们唯一不知道的值就是A（注：对于B，C来说）（<em>block cipher decryption</em>）;借由XOR，我们可以很轻易地得到A的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A = B XOR C</span><br></pre></td></tr></table></figure>
<p>最后，A XOR B XOR C等于0。有了这个公式，我们可以在XOR运算的末尾处设置我们自己的值，就像这样：</p>
<p><code>A XOR B XOR C XOR &quot;7&quot;</code>会在块2的明文当中，偏移量为2的字节处得到7。</p>
<p>下面是相关原理实现的PHP源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!php</span></span><br><span class="line">define(<span class="string">'MY_AES_KEY'</span>, <span class="string">"abcdef0123456789"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aes</span><span class="params">($data, $encrypt)</span> </span>&#123;</span><br><span class="line">    $aes = mcrypt_module_open(MCRYPT_RIJNDAEL_128, <span class="string">''</span>, MCRYPT_MODE_CBC, <span class="string">''</span>);</span><br><span class="line">    $iv = <span class="string">"1234567891234567"</span>;</span><br><span class="line">    mcrypt_generic_init($aes, MY_AES_KEY, $iv);</span><br><span class="line">    <span class="keyword">return</span> $encrypt ? mcrypt_generic($aes,$data) : mdecrypt_generic($aes,$data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">define(<span class="string">'MY_MAC_LEN'</span>, <span class="number">40</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> aes($data, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">    $data = rtrim(aes($data, <span class="keyword">false</span>), <span class="string">"\0"</span>);</span><br><span class="line">    <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line">$v = <span class="string">"a:2:&#123;s:4:\"name\";s:6:\"sdsdsd\";s:8:\"greeting\";s:20:\"echo 'Hello sdsdsd!'\";&#125;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Plaintext before attack: $v\n"</span>;</span><br><span class="line">$b = <span class="keyword">array</span>();</span><br><span class="line">$enc = <span class="keyword">array</span>();</span><br><span class="line">$enc = @encrypt($v);</span><br><span class="line">$enc[<span class="number">2</span>] =  chr(ord($enc[<span class="number">2</span>]) ^ ord(<span class="string">"6"</span>) ^ ord (<span class="string">"7"</span>));</span><br><span class="line">$b = @decrypt($enc);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Plaintext AFTER attack : $b\n"</span>;</span><br></pre></td></tr></table></figure>
<h2 id="收回来解题"><a href="#收回来解题" class="headerlink" title="收回来解题"></a>收回来解题</h2><p>简单针对login代码做个分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">($info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $iv=get_random_iv();</span><br><span class="line">    <span class="comment">#随机生成一个初识向量。</span></span><br><span class="line">    $plain = serialize($info);</span><br><span class="line">    <span class="comment">#序列化$info = array('username'=&gt;$username,'password'=&gt;$password);</span></span><br><span class="line">    $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);</span><br><span class="line">    <span class="comment">#cbc模式下的aes加密明文</span></span><br><span class="line">    $_SESSION[<span class="string">'username'</span>] = $info[<span class="string">'username'</span>];</span><br><span class="line">    setcookie(<span class="string">"iv"</span>, base64_encode($iv));</span><br><span class="line">    <span class="comment">#初识向量经过base64加密。</span></span><br><span class="line">    setcookie(<span class="string">"cipher"</span>, base64_encode($cipher));</span><br><span class="line">    <span class="comment">#把密文再base64加密一次。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我们注意到最后一步， <code>$_SESSION[&#39;username&#39;] = $info[&#39;username&#39;]</code>，而根据info的定义赋值可知，<code>$info[&#39;username&#39;]</code>是我们传进进去的账户名的值。而代码不让我们使用admin，所以此路不通。</p>
<p>然后继续看代码，找到了这串，也调用了flag()</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_SESSION[<span class="string">"username"</span>]))&#123;</span><br><span class="line">        check_login();</span><br><span class="line">        show_homepage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先要不进入刚刚的那个if，就是不满足 <code>set($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;])</code> 然后，要有<code>$_SESSION[“username”]</code>在。</p>
<p>看一下check_login()做了什么</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_login</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'cipher'</span>]) &amp;&amp; <span class="keyword">isset</span>($_COOKIE[<span class="string">'iv'</span>]))&#123;</span><br><span class="line">        <span class="comment">#存在cipher和iv的cookie值</span></span><br><span class="line">        $cipher = base64_decode($_COOKIE[<span class="string">'cipher'</span>]);</span><br><span class="line">        <span class="comment">#密文是base64解码后的cookie值cipher。</span></span><br><span class="line">        $iv = base64_decode($_COOKIE[<span class="string">"iv"</span>]);</span><br><span class="line">        <span class="keyword">if</span>($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123;</span><br><span class="line">            <span class="comment">#如果能成功使用aes解密处铭文</span></span><br><span class="line">            $info = unserialize($plain) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"&lt;p&gt;base64_decode('"</span>.base64_encode($plain).<span class="string">"') can't unserialize&lt;/p&gt;"</span>)</span><br><span class="line">                <span class="comment">#如果不能反序列化解密出的密文，则结束。</span></span><br><span class="line">            $_SESSION[<span class="string">'username'</span>] = $info[<span class="string">'username'</span>];</span><br><span class="line">            <span class="comment">#如果可以反序列化，则将info中的username给session。</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"ERROR!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样经过check_login函数之后，<code>$_SESSION[&#39;username&#39;]</code>就还是我们最开始post的那个username。所以我们就要想如何把<code>$_SESSION[&#39;username&#39;]</code>变成<code>admin</code>，即使我们最开始post的可能是admi2，但是它经过了AES加密和解密阿，这就有得搞了阿。</p>
<h3 id="开始搞事"><a href="#开始搞事" class="headerlink" title="开始搞事"></a>开始搞事</h3><p>通过题目先生成序列化的明文</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$info = <span class="keyword">array</span>(<span class="string">'username'</span>=&gt;<span class="string">'admi2'</span>,<span class="string">'password'</span>=&gt;<span class="string">'l1nk3r'</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize($info)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>a:2:{s:8:&quot;username&quot;;s:5:&quot;admi2&quot;;s:8:&quot;password&quot;;s:6:&quot;l1nk3r&quot;;}</code> </p>
<p>然后就开始分块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;s:8:&quot;userna</span><br><span class="line">me&quot;;s:5:&quot;admi2&quot;;</span><br><span class="line">s:8:&quot;password&quot;;s</span><br><span class="line">:8:&quot;l1nk3r&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>按照CBC字节翻转攻击的套路，我们要修改的是上一个分组对应位置的密文</p>
<p>就是下面会放的脚本中的代码：</p>
<p><code>bs_de[13]=chr(ord(bs_de[13]) ^ ord(&#39;2&#39;) ^ ord(&#39;n&#39;))</code></p>
<p>但有一点需要注意，这样改变后，密文的值发生了改变，将其进行解密后反序列化，是会失败的，从而会把无法反序列化的明文打印出来（因为我们对block 1进行了改变，虽然block 2变成了我们所希望的值，但block 1却变成了未知的量） 所以此时，需要改变iv的值来改变block 1的值 （注：这就是cbc的处理方式，iv的值改变block1的值，block1的值改变block2的值……） 故此，我们需要一个正确的Iv，使block 1依旧为<code>a:2:{s:8:&quot;userna</code></p>
<h3 id="正式解题"><a href="#正式解题" class="headerlink" title="正式解题"></a>正式解题</h3><p>首先页面通过username=admi2，password=l1nk3r登陆，然后通过Chrome的插件EditThisCookie，把cipher的值赋给以下脚本中的cipher</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/t6r5o.jpg" alt="5"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote_plus</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">'9AOOYlmVvT4xmjViSqORmkZT%2Bxm2mJf0tsuHd%2BUcf1xrghHyXp8FRoQjkE%2FR4dJu8U8DJfcHcHEGJI2ntOYxHw%3D%3D'</span></span><br><span class="line">cipher = unquote(cipher)</span><br><span class="line">cipher_de = base64.b64decode(cipher)</span><br><span class="line">ch = chr(ord(cipher_de[<span class="number">13</span>]) ^ ord(<span class="string">'2'</span>) ^ ord(<span class="string">'n'</span>))</span><br><span class="line">cipher_de=cipher_de[<span class="number">0</span>:<span class="number">13</span>]+ch+cipher_de[<span class="number">14</span>::]</span><br><span class="line">rs = base64.b64encode(cipher_de)</span><br><span class="line"><span class="keyword">print</span> quote_plus(rs)</span><br></pre></td></tr></table></figure>
<p>然后将运行结果替换cipher，并且点击绿的勾保存</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/5342j.jpg" alt="4"></p>
<p>然后在浏览器按住回车运行，这里前往不要刷新，因为刷新会重新提交表单，然后随机字符又变了。这是我的结果</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/wq2wi.png" alt="6"></p>
<p>然后base64解码下,其实已经替换成功了。</p>
<p><img src="http://l1nk3r.xmutsec.com/blog/zt02m.png" alt="7"></p>
<p>这里我们将第一组的密文改了，第一组解密之后又不是原来的那个字符串，当然反序列化失败。所以现在要改回来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote_plus</span><br><span class="line"></span><br><span class="line">mingwen_de=<span class="string">'x2FPwTAFf/svVLvvU25fDW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjA6IiI7fQ=='</span></span><br><span class="line"><span class="comment">#base64_decode('这里面的') can't unserialize</span></span><br><span class="line">mingwen = base64.b64decode(mingwen_de)</span><br><span class="line"><span class="keyword">print</span> mingwen</span><br><span class="line"></span><br><span class="line">iv = <span class="string">'6S%2FcC7czBRvE0iSkTANYaQ%3D%3D'</span></span><br><span class="line"><span class="comment">#此时cookie里的iv</span></span><br><span class="line">iv = unquote(iv)</span><br><span class="line">iv_de = base64.b64decode(iv)</span><br><span class="line">new = <span class="string">'a:2:&#123;s:8:"userna'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    iv_de = iv_de[:i] + chr(ord(iv_de[i]) ^ ord(mingwen[i]) ^ ord(new[i])) + iv_de[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(base64.b64encode(iv_de))</span><br><span class="line"><span class="comment">#用这个结果把原来的iv换掉</span></span><br></pre></td></tr></table></figure>
<p><img src="http://l1nk3r.xmutsec.com/blog/7nb7b.jpg" alt="8"></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前提知识"><span class="toc-number">1.</span> <span class="toc-text">前提知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#举个例子"><span class="toc-number">2.</span> <span class="toc-text">举个例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#收回来解题"><span class="toc-number">3.</span> <span class="toc-text">收回来解题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开始搞事"><span class="toc-number">3.1.</span> <span class="toc-text">开始搞事</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#正式解题"><span class="toc-number">3.2.</span> <span class="toc-text">正式解题</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&text=cbc字节翻转攻击"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&is_video=false&description=cbc字节翻转攻击"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=cbc字节翻转攻击&body=Check out this article: http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&title=cbc字节翻转攻击"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.lmxspace.com/2018/05/07/cbc字节翻转攻击/&name=cbc字节翻转攻击&description=&lt;p&gt;今天遇到一道题，感觉学习了一个新的姿势，所以记录一下过程。&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 l1nk3r
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </nav>
    <a href="http://www.miitbeian.gov.cn/">闽ICP备19007817号</a> 
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


