<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="0x01 序言&amp;emsp;&amp;emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 反射机制 ，这东西以前为了理解，可是搞了好久呢。">
<meta name="keywords" content="java,反射">
<meta property="og:type" content="article">
<meta property="og:title" content="Java-web学习之路-反射机制">
<meta property="og:url" content="http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/index.html">
<meta property="og:site_name" content="l1nk3r&#39;s blog">
<meta property="og:description" content="0x01 序言&amp;emsp;&amp;emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 反射机制 ，这东西以前为了理解，可是搞了好久呢。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/c3esc.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/qxly4.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/ua84j.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/4evnv.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/dobyo.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/dncmc.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/4zcq1.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/410wz.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/deizp.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/pj482.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/kl5gm.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/9urr6.png">
<meta property="og:image" content="http://po8p59xe5.bkt.clouddn.com/blog/ytmwa.gif">
<meta property="og:updated_time" content="2019-03-23T05:48:44.366Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java-web学习之路-反射机制">
<meta name="twitter:description" content="0x01 序言&amp;emsp;&amp;emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 反射机制 ，这东西以前为了理解，可是搞了好久呢。">
<meta name="twitter:image" content="http://po8p59xe5.bkt.clouddn.com/blog/c3esc.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Java-web学习之路-反射机制</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/03/15/聊一聊近期wordpress的漏洞/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&text=Java-web学习之路-反射机制"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&is_video=false&description=Java-web学习之路-反射机制"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Java-web学习之路-反射机制&body=Check out this article: http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&name=Java-web学习之路-反射机制&description=&lt;h1 id=&#34;0x01-序言&#34;&gt;&lt;a href=&#34;#0x01-序言&#34; class=&#34;headerlink&#34; title=&#34;0x01 序言&#34;&gt;&lt;/a&gt;0x01 序言&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 &lt;strong&gt;反射机制&lt;/strong&gt; ，这东西以前为了理解，可是搞了好久呢。&lt;br&gt;&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-序言"><span class="toc-number">1.</span> <span class="toc-text">0x01 序言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-反射机制"><span class="toc-number">2.</span> <span class="toc-text">0x02 反射机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、何为反射"><span class="toc-number">2.1.</span> <span class="toc-text">一、何为反射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、反射机制的使用"><span class="toc-number">2.2.</span> <span class="toc-text">二、反射机制的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-获取类对象的办法"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.获取类对象的办法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-类的构造器对象的方法"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.类的构造器对象的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-创建实例"><span class="toc-number">2.2.3.</span> <span class="toc-text">3.创建实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-获取类声明的方法"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.获取类声明的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-获取类的方法对象方法"><span class="toc-number">2.2.5.</span> <span class="toc-text">5.获取类的方法对象方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-调用方法"><span class="toc-number">2.2.6.</span> <span class="toc-text">6.调用方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03应用场景"><span class="toc-number">3.</span> <span class="toc-text">0x03应用场景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-弹个计算器"><span class="toc-number">4.</span> <span class="toc-text">0x04 弹个计算器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Java-web学习之路-反射机制
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">l1nk3r's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-03-23T05:45:10.000Z" itemprop="datePublished">2019-03-23</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/java/">java</a>, <a class="tag-link" href="/tags/反射/">反射</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="0x01-序言"><a href="#0x01-序言" class="headerlink" title="0x01 序言"></a>0x01 序言</h1><p>&emsp;&emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 <strong>反射机制</strong> ，这东西以前为了理解，可是搞了好久呢。<br><a id="more"></a> </p>
<h1 id="0x02-反射机制"><a href="#0x02-反射机制" class="headerlink" title="0x02 反射机制"></a>0x02 反射机制</h1><h2 id="一、何为反射"><a href="#一、何为反射" class="headerlink" title="一、何为反射"></a>一、何为反射</h2><p>&emsp;&emsp;反射 (Reflection) 是 Java 的特征之一，它允许运行中的 Java 程序获取自身的信息，并且可以操作类或对象的内部属性，Oracle官网对这个特征的描述是这样的</p>
<blockquote>
<p>Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.<br>The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.</p>
</blockquote>
<p>&emsp;&emsp;简单来说通过反射机制，我们可以java程序运行过程中获取到每一个类型的成员和成员的信息。<br>&emsp;&emsp;首先 <strong>JVM</strong>是<strong>java</strong>虚拟机这个是大家众所周知的一个东西，并且 <strong>java</strong> 代码是运行在 <strong>JVM</strong> 之上。<strong>java</strong> 之所以能够拥有跨平台的特性，正是依赖于这个 <strong>JVM</strong> ，下图是一个 <strong>java</strong> 运行过程中的内存加载模型。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/c3esc.png" alt=""><br>&emsp;&emsp;下面可以看个例子方便理解,我们先创建两个类，分别是Reflection1和Reflection2。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Reflection1.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reflection1</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doReflection1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Reflection1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Reflection2.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reflection2</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doReflection2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Reflection2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>正常我们要调用这两个类需要这样写。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReflectionTest</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">//new Reflection1().doReflection1();</span></span><br><span class="line">        <span class="keyword">new</span> Reflection2().doReflection2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="http://po8p59xe5.bkt.clouddn.com/blog/qxly4.png" alt=""><br>&emsp;&emsp;首先你的这个代码会被编译为 <strong>.class</strong> 的文件，并且被类加载器加载进 <strong>jvm</strong> 的内存中，你的类 <strong>Reflection2</strong> 加载到方法区中，创建了 <strong>Reflection2</strong> 类的 <strong>class对象</strong> 到堆中，注意这个不是 <strong>new</strong> 出来的对象，而是类的类型对象，每个类只有一个 <strong>class对象</strong> ，作为方法区类的数据结构的接口。 <strong>jvm</strong> 创建对象前，会先检查类是否加载，寻找类对应的 <strong>class对象</strong> ，若加载好，则为你的对象分配内存，初始化也就是代码: <strong>new Reflection2</strong> 。<br>&emsp;&emsp;而假设现在又有一个 <strong>Reflection1</strong> 的类，也就是我们代码中注释的部分，如果我们要对它进行调用，首先我们需要去掉这一行代码前面的两个反斜杠，然后在 <strong>javac Reflection1.java</strong> 对其进行编译，最后使用 <strong>java Reflection1</strong> 进行运行，得到我们想要的结果。<br>这样的过程是相当的麻烦，而为了解决这个需求，反射 (Reflection) 特性应需而生。<br>&emsp;&emsp;我们先看个例子，如何在利用反射机制实现我们刚刚的需求，首先我们先创建一个 <strong>Reflection.txt</strong> 文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class = Reflection1</span><br><span class="line">method = doReflection1</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;然后我们看一下实现代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReflectionTest2</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"rowtypes"</span>,<span class="string">"unchecked"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> FileNotFoundException, IOException, ClassNotFoundException, NoSuchMethodException, SecurityException,</span></span><br><span class="line"><span class="function">            InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException </span>&#123;</span><br><span class="line">        File ConfigFile= <span class="keyword">new</span> File(<span class="string">"/Users/l1nk3r/Desktop/java reflect/Reflection.txt"</span>);</span><br><span class="line">        Properties ReflectionConfig = <span class="keyword">new</span> Properties();</span><br><span class="line">        ReflectionConfig.load(<span class="keyword">new</span> FileInputStream(ConfigFile));</span><br><span class="line">        String className = (String)ReflectionConfig.get(<span class="string">"class"</span>);</span><br><span class="line">        String methodName = (String)ReflectionConfig.get(<span class="string">"method"</span>);</span><br><span class="line">        <span class="comment">//根据类，名称创建类对象</span></span><br><span class="line">        Class clazz = Class.forName(className);</span><br><span class="line">        <span class="comment">//根据方法名称获取方法</span></span><br><span class="line">        Method m = clazz.getMethod(methodName);</span><br><span class="line">        <span class="comment">//获取构造器</span></span><br><span class="line">        Constructor c = clazz.getConstructor();</span><br><span class="line">        <span class="comment">//根据构造器实例化出相关对象</span></span><br><span class="line">        Object service = c.newInstance();</span><br><span class="line">        <span class="comment">//调用对象的指定方法</span></span><br><span class="line">        m.invoke(service);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;那么如果我们需要调用 <strong>Reflection1</strong> 里的 <strong>doReflection1</strong> ，只需要修改 <strong>Reflection.txt</strong> 文件，同理需要调用 <strong>Reflection2</strong> 里的 <strong>doReflection2</strong> ，也是修改这个文件，最后下图是效果。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/ua84j.png" alt=""><br>&emsp;&emsp;所以上面例子中如果 <strong>Reflection.txt</strong> 文件没有进行相关类和方法的设置，那么对于程序运行来说是不知道运行对象是谁。所以java的反射是可以动态地创建对象并调用其属性，这样的对象的类型在编译期是未知的。<br>&emsp;&emsp;Java 反射主要提供以下功能：</p>
<ul>
<li>在运行时判断任意一个对象所属的类；</li>
<li>在运行时构造任意一个类的对象；</li>
<li>在运行时判断任意一个类所具有的成员变量和方法（通过反射甚至可以调用private方法）；</li>
<li>在运行时调用任意一个对象的方法</li>
</ul>
<p><strong>重点：是运行时而不是编译时</strong></p>
<h2 id="二、反射机制的使用"><a href="#二、反射机制的使用" class="headerlink" title="二、反射机制的使用"></a>二、反射机制的使用</h2><p>&emsp;&emsp;首先从第一章节的样例代码中，我们看到了反射机制有几个类，他们分别是 <strong>class</strong> 、 <strong>Constructor</strong> 、 <strong>Method</strong> 三个类，除此之外还有类没有出现在我们上面的例子中，它是 <strong>Field</strong> ,简单介绍一下这几个类的作用。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class                ----类对象</span><br><span class="line">Constructor          ----类的构造器对象</span><br><span class="line">Field                ----类的属性对象</span><br><span class="line">Method               ----类的方法对象</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;这可太真实了，java真实一门万物皆对象的语言（小声bb。而java反射机制的相关对象的类和方法均在一般都在 <strong>java.lang.relfect</strong> 包里。</p>
<h3 id="1-获取类对象的办法"><a href="#1-获取类对象的办法" class="headerlink" title="1.获取类对象的办法"></a>1.获取类对象的办法</h3><p>&emsp;&emsp;在反射机制中，有三种方式可以获取到class对象,他们分别如下：</p>
<ol>
<li>使用 <strong>Class</strong> 类的 <strong>forName</strong> 静态方法。</li>
<li>调用运行时类本身的 <strong>.class</strong> 属性</li>
<li>通过类的对象 <strong>.getClass()</strong> </li>
</ol>
<p>下面可以看个例子:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetClassDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        <span class="comment">//以String类为例：</span></span><br><span class="line">        String str=<span class="string">"hello world"</span>;</span><br><span class="line">        <span class="comment">//方式一：通过Class类的静态方法forName</span></span><br><span class="line">        Class&lt;?&gt; clazz1 =Class.forName(<span class="string">"java.lang.String"</span>);</span><br><span class="line">        <span class="comment">//方式二：通过类的class属性</span></span><br><span class="line">        Class&lt;?&gt; clazz2 =String.class;</span><br><span class="line">        <span class="comment">//方式三 ：通过对象的getClass()方法</span></span><br><span class="line">        Class&lt;?&gt; clazz3 =str.getClass();</span><br><span class="line">        System.out.println(clazz1.getName());</span><br><span class="line">        System.out.println(clazz2.getName());</span><br><span class="line">        System.out.println(clazz3.getName());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;我们知道java下字符串常量是 <strong>java.lang.String</strong> 这个类实例的引用。我们在上面的例子中通过三种方式获取到相关类对象的名字。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/4evnv.png" alt=""></p>
<h3 id="2-类的构造器对象的方法"><a href="#2-类的构造器对象的方法" class="headerlink" title="2.类的构造器对象的方法"></a>2.类的构造器对象的方法</h3><p>获取类构造器的方法有以下几种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//根据指定参数获得public构造器</span><br><span class="line">Constructor getConstructor(Class[] params);</span><br><span class="line">//获得public的所有构造器</span><br><span class="line">Constructor[] getConstructors();</span><br><span class="line">//根据指定参数获得public和非public的构造器</span><br><span class="line">Constructor getDeclaredConstructor(Class[] params);</span><br><span class="line">//获取所有public和非public的构造器 </span><br><span class="line">Constructor[] getDeclaredConstructors();</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;下面看个例子，例子中创建一个 <strong>UserInfo</strong> 的方法，并且设置四个类的构造器，其中三个是 <strong>public</strong> 属性，另一个是 <strong>private</strong> 属性。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UserInfo.java</span></span><br><span class="line"><span class="keyword">package</span> com.l1nk3r.reflect;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserInfo</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserInfo</span><span class="params">(<span class="keyword">int</span> userId)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserInfo</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.name = name;</span><br><span class="line">    	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserInfo</span><span class="params">(<span class="keyword">int</span> userId, String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;我们看一下上面这几种方法最后的结果分别是：<br>&emsp;&emsp;使用 <strong>getConstructors</strong> ，返回结果如下所示<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/dobyo.png" alt=""><br>&emsp;&emsp;使用 <strong>getDeclaredConstructors</strong> ，返回结果如下所示，两者一对比，大家应该就明白了这两个方法差别在哪。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/dncmc.png" alt=""></p>
<h3 id="3-创建实例"><a href="#3-创建实例" class="headerlink" title="3.创建实例"></a>3.创建实例</h3><p>&emsp;&emsp;通过反射来生成对象主要有两种方式，一种是使用 <strong>Class</strong> 对象的 <strong>newInstance()</strong> 方法来创建Class对象对应类的实例；<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/4zcq1.png" alt=""><br>&emsp;&emsp;另一种是先通过 <strong>Class</strong> 对象获取指定的 <strong>Constructor</strong> 对象，再调用 <strong>Constructor</strong> 对象的 <strong>newInstance()</strong> 方法来创建实例。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/410wz.png" alt=""><br>&emsp;&emsp;我们可以看到两个方法区别在于，第二个方法可以用指定的构造器构造类的实例，实际用起来也比较好用。</p>
<h3 id="4-获取类声明的方法"><a href="#4-获取类声明的方法" class="headerlink" title="4.获取类声明的方法"></a>4.获取类声明的方法</h3><p>&emsp;&emsp;获取类声明的方法有以下这几种：</p>
<ul>
<li>Field  getField(String name);获得指定名字的公共属性</li>
<li>Field[] getFields();获得全部公共属性（包括继承父类，实现接口）</li>
<li>Field getDclaredField(String name);获得指定名字的属性</li>
<li>Field[] getDeclaredFields();获得当前类的全部属性</li>
</ul>
<p>&emsp;&emsp;下面可以看个例子,这里将name设置为public，stuid、sex、type设置为private，brith不进行设置。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Student.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> stuid=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> String name=<span class="string">"l1nk3r"</span>;</span><br><span class="line">	<span class="keyword">private</span> String sex=<span class="string">"男"</span>;</span><br><span class="line">	<span class="keyword">private</span> String type=<span class="string">"test"</span>;</span><br><span class="line">	Date birth;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;利用下面的代码运行结果一目了然,由于getField的方法要求必须为public声明，因此调用sex出现了报错<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/deizp.png" alt=""><br>&emsp;&emsp;我们将代码注释之后即可看到上面几种方式的分别实现效果。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/pj482.png" alt=""></p>
<h3 id="5-获取类的方法对象方法"><a href="#5-获取类的方法对象方法" class="headerlink" title="5.获取类的方法对象方法"></a>5.获取类的方法对象方法</h3><ul>
<li>Method getMethod(String name, Class[] params) – 使用特定的参数类型，获得命名的公共方法 </li>
<li>Method[] getMethods() – 获得类的所有公共方法 </li>
<li>Method getDeclaredMethod(String name, Class[] params) – 使用特写的参数类型，获得类声明的命名的方法 </li>
<li>Method[] getDeclaredMethods() – 获得类声明的所有方法 </li>
</ul>
<p>下面可以看个例子,这里将getSex、setSex、getType均设置为private，其他设置为public。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;利用下面的代码运行结果一目了然,由于getMethod的方法要求必须为public声明，因此调用getSex出现了报错。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/kl5gm.png" alt=""><br>&emsp;&emsp;注释掉报错继续运行下去，这几个方法的用法结果一目了然，两个区别在于 <strong>getMethods</strong> 和 <strong>getMethod</strong> 无法获取 <strong>private</strong> 方法，而 <strong>getDeclaredMethods</strong> 和<strong>getDeclaredMethod</strong> 可以。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.l1nk3r.reflect;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		Student s=<span class="keyword">new</span> Student();</span><br><span class="line">		Class&lt;?&gt; c=s.getClass();</span><br><span class="line">		<span class="comment">//获得方法</span></span><br><span class="line">		<span class="comment">//Method f1=c.getMethod("getSex");</span></span><br><span class="line">		<span class="comment">//System.out.println("getMethod(\"getSex\")方法获取到的:"+f1);</span></span><br><span class="line">		Method[] f2=c.getMethods();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;f2.length;i++) &#123;</span><br><span class="line">			System.out.println(<span class="string">"getMethods()方法获取到的:"</span>+f2[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		Method f3=c.getDeclaredMethod(<span class="string">"getSex"</span>);</span><br><span class="line">		System.out.println(<span class="string">"getDeclaredMethod(\"getSex\");方法获取到的:"</span>+f3);</span><br><span class="line">		Method[] f4=c.getDeclaredMethods();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;f4.length;i++) &#123;</span><br><span class="line">			System.out.println(<span class="string">"getDeclaredMethods()方法获取到的:"</span>+f4[i]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="http://po8p59xe5.bkt.clouddn.com/blog/9urr6.png" alt=""></p>
<h3 id="6-调用方法"><a href="#6-调用方法" class="headerlink" title="6.调用方法"></a>6.调用方法</h3><p>&emsp;&emsp;前面我们说了一堆如何获取类，对象，方法，注册实例，声明等，但是最后我在拿到了我们想要的数据之后，还是需要调用该方法，调用方法使用的是 <strong>invoke</strong> 方法。我们可以看个例子，在例子中首先通过运行 <strong>methodClass</strong> 的 <strong>.class</strong> 属性获取类对象的方法，然后通过 <strong>newInstance</strong> 方式，实例化 <strong>methodClass</strong> 类，再通过 <strong>getMothod</strong> 方法获取 <strong>methodClass</strong> 类中的 <strong>add</strong> 方法，最后通过 <strong>invoke</strong> 方法执行 <strong>methodClass</strong> 类中的 <strong>add</strong> 方法，并执行 <strong>1+4</strong> 的运算，最后结果为 <strong>5</strong> 。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.l1nk3r.reflect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InvokeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException </span>&#123;</span><br><span class="line">        Class&lt;?&gt; klass = methodClass.class;</span><br><span class="line">        <span class="comment">//创建methodClass的实例</span></span><br><span class="line">        Object obj = klass.newInstance();</span><br><span class="line">        <span class="comment">//获取methodClass类的add方法</span></span><br><span class="line">        Method method = klass.getMethod(<span class="string">"add"</span>,<span class="keyword">int</span>.class,<span class="keyword">int</span>.class);</span><br><span class="line">        <span class="comment">//调用method对应的方法 =&gt; add(1,4)</span></span><br><span class="line">        Object result = method.invoke(obj,<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">methodClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> fuck = <span class="number">3</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="0x03应用场景"><a href="#0x03应用场景" class="headerlink" title="0x03应用场景"></a>0x03应用场景</h1><p>&emsp;&emsp;反射机制存在很多java下的框架里，例如struts、spring这种，开发者为了保证框架的通用性，所以需要根据配置文件加载不同的类或者对象，调用不同的方法。<br>&emsp;&emsp;例如 <strong>spring</strong> 框架下可以通过 <strong>XML</strong> 配置模式装载 <strong>Bean</strong> ，它的过程如下：</p>
<ol>
<li>将程序内所有 XML 或 Properties 配置文件加载入内存中</li>
<li>Java类里面解析xml或properties里面的内容，得到对应实体类的字节码字符串以及相关的属性信息</li>
<li>使用反射机制，根据这个字符串获得某个类的Class实例</li>
<li>动态配置实例的属性</li>
</ol>
<p>&emsp;&emsp;在Struts框架下也用到了反射机制，在运用 <strong>Struts2</strong> 框架的开发中我们一般会在 <strong>struts.xml</strong> 里去配置 <strong>Action</strong> ，比如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;action name=&quot;login&quot; class=&quot;org.l1nk3r.test.action.SimpleLoginAction&quot;</span><br><span class="line">               method=&quot;execute&quot;&gt;</span><br><span class="line">           &lt;result&gt;/index.jsp&lt;/result&gt;</span><br><span class="line">           &lt;result name=&quot;error&quot;&gt;login.jsp&lt;/result&gt;</span><br><span class="line">       &lt;/action&gt;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;配置文件与 <strong>Action</strong> 建立了一种映射关系，当 <strong>View</strong> 层发出请求时，请求会被 <strong>StrutsPrepareAndExecuteFilter</strong> 拦截，然后 <strong>StrutsPrepareAndExecuteFilter</strong> 会去动态地创建 <strong>Action</strong> 实例。比如我们请求 <strong>login.action</strong>，那么 <strong>StrutsPrepareAndExecuteFilter</strong> 就会去解析 <strong>struts.xml</strong> 文件，检索 <strong>action</strong> 中 <strong>name</strong> 为 <strong>login</strong> 的 <strong>Action</strong> ，并根据 <strong>class</strong> 属性创建 <strong>SimpleLoginAction</strong> 实例，并用 <strong>invoke</strong> 方法来调用 <strong>execute</strong> 方法，这个过程离不开反射。<br>&emsp;&emsp;还有在java底下使用数据库的时候，会经常看到下述相关代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionJDBC</span> </span>&#123;  </span><br><span class="line">    <span class="comment">//驱动程序就是之前在classpath中配置的JDBC的驱动程序的JAR 包中  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBDRIVER = <span class="string">"com.mysql.jdbc.Driver"</span>;  </span><br><span class="line">    <span class="comment">//连接地址是由各个数据库生产商单独提供的，所以需要单独记住  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBURL = <span class="string">"jdbc:mysql://localhost:3306/test"</span>;  </span><br><span class="line">    <span class="comment">//连接数据库的用户名  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBUSER = <span class="string">"root"</span>;  </span><br><span class="line">    <span class="comment">//连接数据库的密码  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DBPASS = <span class="string">""</span>;  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;  </span><br><span class="line">        Connection con = <span class="keyword">null</span>; <span class="comment">//表示数据库的连接对象  </span></span><br><span class="line">        Class.forName(DBDRIVER); <span class="comment">//1、使用CLASS 类加载驱动程序 ,反射机制的体现 </span></span><br><span class="line">        con = DriverManager.getConnection(DBURL,DBUSER,DBPASS); <span class="comment">//2、连接数据库  </span></span><br><span class="line">        System.out.println(con);  </span><br><span class="line">        con.close(); <span class="comment">// 3、关闭数据库  </span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;上面的代码就是用到了反射机制，首先通过 <strong>Class.forName</strong> 加载数据库的驱动程序 （通过反射加载，前提是引入相关了Jar包），然后通过 <strong>DriverManager</strong> 类进行数据库的连接，连接的时候要输入数据库的连接地址、用户名、密码，最后通过 <strong>Connection</strong> 接口接收连接。</p>
<h1 id="0x04-弹个计算器"><a href="#0x04-弹个计算器" class="headerlink" title="0x04 弹个计算器"></a>0x04 弹个计算器</h1><p>&emsp;&emsp;之前介绍反序列化的时候，介绍过我们可以通过重写readObject方法，达到反序列化过程可以任意执行命令的目的，现在我们换个方法，通过反射的方法重写readObject，然后反序列化的时候执行命令。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ReflectionCalcObject.java</span></span><br><span class="line"><span class="keyword">package</span> com.l1nk3r.reflect;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReflectionCalcObject</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="comment">//重写readObject()方法</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream in)</span> <span class="keyword">throws</span> IOException,ClassNotFoundException</span>&#123;</span><br><span class="line">        in.defaultReadObject();<span class="comment">//调用原始的readOject方法</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;<span class="comment">//通过反射方法执行命令；</span></span><br><span class="line">        Method method= java.lang.Runtime.class.getMethod(<span class="string">"exec"</span>, String.class);</span><br><span class="line">        Object result = method.invoke(Runtime.getRuntime(), <span class="string">"open /Applications/Calculator.app/"</span>);    </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>关键在于这两行代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Method method= java.lang.Runtime.class.getMethod(<span class="string">"exec"</span>, String.class);</span><br><span class="line">Object result = method.invoke(Runtime.getRuntime(), <span class="string">"open /Applications/Calculator.app/"</span>);</span><br></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;通过运行 <strong>java.lang.Runtime</strong> 这个类的 <strong>.class</strong> 属性，并使用 <strong>getMethod</strong> 方法来获取我们要执行命令的方法 <strong>exec</strong> ，最后我们通过 <strong>invoke</strong> 来实现注册这个方法，打开计算器。<br><img src="http://po8p59xe5.bkt.clouddn.com/blog/ytmwa.gif" alt=""></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://juejin.im/post/5aa7d9426fb9a028df224e30" target="_blank" rel="noopener">什么是Java内存模型</a><br><a href="https://www.sczyh30.com/posts/Java/java-reflection-1/#%E4%B8%80%E3%80%81%E5%9B%9E%E9%A1%BE%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%8D%E5%B0%84%EF%BC%9F" target="_blank" rel="noopener">深入解析Java反射（1） - 基础</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-序言"><span class="toc-number">1.</span> <span class="toc-text">0x01 序言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-反射机制"><span class="toc-number">2.</span> <span class="toc-text">0x02 反射机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、何为反射"><span class="toc-number">2.1.</span> <span class="toc-text">一、何为反射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、反射机制的使用"><span class="toc-number">2.2.</span> <span class="toc-text">二、反射机制的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-获取类对象的办法"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.获取类对象的办法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-类的构造器对象的方法"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.类的构造器对象的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-创建实例"><span class="toc-number">2.2.3.</span> <span class="toc-text">3.创建实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-获取类声明的方法"><span class="toc-number">2.2.4.</span> <span class="toc-text">4.获取类声明的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-获取类的方法对象方法"><span class="toc-number">2.2.5.</span> <span class="toc-text">5.获取类的方法对象方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-调用方法"><span class="toc-number">2.2.6.</span> <span class="toc-text">6.调用方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03应用场景"><span class="toc-number">3.</span> <span class="toc-text">0x03应用场景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-弹个计算器"><span class="toc-number">4.</span> <span class="toc-text">0x04 弹个计算器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&text=Java-web学习之路-反射机制"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&is_video=false&description=Java-web学习之路-反射机制"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Java-web学习之路-反射机制&body=Check out this article: http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&title=Java-web学习之路-反射机制"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://www.lmxspace.com/2019/03/23/Java-web学习之路-反射机制/&name=Java-web学习之路-反射机制&description=&lt;h1 id=&#34;0x01-序言&#34;&gt;&lt;a href=&#34;#0x01-序言&#34; class=&#34;headerlink&#34; title=&#34;0x01 序言&#34;&gt;&lt;/a&gt;0x01 序言&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp;绝不咕咕咕，第二篇聊一下java下一个比较独特的东西 &lt;strong&gt;反射机制&lt;/strong&gt; ，这东西以前为了理解，可是搞了好久呢。&lt;br&gt;&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 l1nk3r
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/Friends/">Friends</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


